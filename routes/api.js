function ensureAuthenticated(e,r,t){if(e.isAuthenticated())return t();e.flash("error_msg","You are not logged in"),r.redirect("/users/login")}var express=require("express"),router=express.Router(),Article=require("../models/articles");router.get("/",function(e,r){r.render("api")}),router.get("/articles",function(e,r){var t=e.query;Article.getArticles(t,function(e,t){if(e)throw e;r.json(t)})}),router.get("/articles/:_id",function(e,r){Article.getArticleByID(e.params._id,function(e,t){if(e)throw e;r.json(t)})}),router.post("/articles/add",function(e,r){var t=e.body.title,i=e.body.content;e.checkBody("title","Title is required").notEmpty(),e.checkBody("content","Content is required").notEmpty();var o=e.user.id,n=e.user.name,s=e.validationErrors();if(s)r.render("index",{errors:s});else{console.log("Success");var c=new Article({title:t,content:{text:i},author:{id:o,name:n}});Article.addArticle(c,function(e,r){if(e)throw e;console.log(r)}),e.flash("success_msg","Article saved"),r.redirect("/")}}),module.exports=router;
//# sourceMappingURL=./api.js.map